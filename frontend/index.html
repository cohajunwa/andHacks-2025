<!DOCTYPE html>
<html style="font-size: 16px" lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <title>Home</title>
    <link rel="stylesheet" href="nicepage.css" media="screen" />
    <link rel="stylesheet" href="index.css" media="screen" />
    <script
      class="u-script"
      type="text/javascript"
      src="jquery.js"
      defer=""
    ></script>
    <script
      class="u-script"
      type="text/javascript"
      src="nicepage.js"
      defer=""
    ></script>
    <meta name="generator" content="Nicepage 7.13.0, nicepage.com" />

    <link
      id="u-page-google-font"
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Roboto:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800"
    />
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": "",
        "logo": "/images/whiteglobe.png?rand=bffd"
      }
    </script>
    <meta name="theme-color" content="#478ac9" />
    <meta property="og:title" content="Home" />
    <meta property="og:type" content="website" />
    <meta data-intl-tel-input-cdn-path="intlTelInput/" />
  </head>
  <body
    data-home-page="Home.html"
    data-home-page-title="Home"
    data-path-to-root="./"
    data-include-products="false"
    class="u-body u-clearfix u-xl-mode"
    data-lang="en"
  >
    <header
      class="u-clearfix u-header u-palette-1-light-2 u-header"
      id="header"
    >
      <div
        class="u-clearfix u-sheet u-valign-middle-lg u-valign-middle-md u-valign-middle-sm u-valign-middle-xl u-sheet-1"
      >
        <a
          href="#"
          class="u-align-left-xs u-image u-logo u-image-1"
          data-image-width="512"
          data-image-height="512"
        >
          <img
            src="/images/whiteglobe.png?rand=bffd"
            class="u-logo-image u-logo-image-1"
          />
        </a>
        <nav
          class="u-menu u-menu-one-level u-offcanvas u-menu-1"
          role="navigation"
          aria-label="Menu navigation"
        >
          <div
            class="menu-collapse"
            style="font-size: 1rem; letter-spacing: 0px"
          >
            <a
              class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-hamburger-link u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
              href="#"
              tabindex="-1"
              aria-label="Open menu"
              aria-controls="fd2e"
            >
              <svg class="u-svg-link" viewBox="0 0 24 24">
                <use xlink:href="#menu-hamburger"></use>
              </svg>
              <svg
                class="u-svg-content"
                version="1.1"
                id="menu-hamburger"
                viewBox="0 0 16 16"
                x="0px"
                y="0px"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g>
                  <rect y="1" width="16" height="2"></rect>
                  <rect y="7" width="16" height="2"></rect>
                  <rect y="13" width="16" height="2"></rect>
                </g>
              </svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1" role="menubar">
              <li role="none" class="u-nav-item">
                <a
                  role="menuitem"
                  class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                  href="./"
                  style="padding: 0px 20px"
                  >Home</a
                >
              </li>
              <li role="none" class="u-nav-item">
                <a
                  role="menuitem"
                  class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
                  href="About.html"
                  style="padding: 0px 20px"
                  >About</a
                >
              </li>
            </ul>
          </div>
          <div
            class="u-custom-menu u-nav-container-collapse"
            id="fd2e"
            role="region"
            aria-label="Menu panel"
          >
            <div
              class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav"
            >
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div
                  class="u-menu-close"
                  tabindex="-1"
                  aria-label="Close menu"
                ></div>
                <ul
                  class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"
                  role="menubar"
                >
                  <li role="none" class="u-nav-item">
                    <a
                      role="menuitem"
                      class="u-button-style u-nav-link"
                      href="./"
                      >Home</a
                    >
                  </li>
                  <li role="none" class="u-nav-item">
                    <a
                      role="menuitem"
                      class="u-button-style u-nav-link"
                      href="About.html"
                      >About</a
                    >
                  </li>
                </ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div>
    </header>
    <section class="u-clearfix u-section-1" id="block-1">
      <div class="u-clearfix u-sheet u-sheet-1">
        <div
          class="data-layout-selected u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1"
        >
          <div class="u-layout">
            <div class="u-layout-col">
              <div class="u-container-align-center u-container-style u-layout-cell u-size-30 u-layout-cell-1">
                <div class="u-border-2 u-border-grey-75 u-container-layout u-container-layout-1">
                  <h4 class="u-align-center u-text u-text-default u-text-1">Submit an image here </h4>
                  <div class="video-container">
                    <video id="video" autoplay playsinline></video>
                  </div>
                  
      <button id="snap">Take Photo</button>
      <div class="canvas-container">
        <canvas id="canvas"></canvas>
      </div>
      <div class="form-popup" id="userForm">
  <form action="/action_page.php" class="form-container">
    <h1>Enter Photo Details</h1>

    <label for="description"><b>Describe the photo</b></label>
    <input type="text" id="description" placeholder="Quick description of the type of waste" name="description" required>

    <button type="submit" class="btn">Submit Photo</button>
    <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
  </form>
</div>

                  <script>
  let latitude = null;
  let longitude = null;
  let photoBlob = null;  // temporary storage for captured photo
  let photoId = null;
  let timestamp = null;

  // Ask for camera access
  const video = document.getElementById("video");
  navigator.mediaDevices.getUserMedia({ video: true })
    .then((stream) => (video.srcObject = stream))
    .catch((err) => console.error("Error accessing camera: ", err));

  // When "Take Photo" is clicked
  document.getElementById("snap").addEventListener("click", () => {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition((position) => {
        latitude = position.coords.latitude;
        longitude = position.coords.longitude;
      });
    }

    // Capture frame from video
    const canvas = document.getElementById("canvas");
    const context = canvas.getContext("2d");
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    context.drawImage(video, 0, 0, canvas.width, canvas.height);

    // Save to blob (donâ€™t send yet)
    timestamp = Date.now();
    photoId = timestamp + Math.random();
    canvas.toBlob((blob) => {
      photoBlob = blob;
      openForm();  // now open the form for description
    }, "image/jpeg");
  });

  // Handle form submission
  document.querySelector("#userForm form").addEventListener("submit", (event) => {
    event.preventDefault();  // stop page reload
    const description = document.getElementById("description").value;

    if (!photoBlob) {
      alert("No photo captured yet!");
      return;
    }

    const formData = new FormData();
    formData.append("photo", photoBlob, `${photoId}.jpg`);
    formData.append("id", photoId);
    formData.append("timestamp", timestamp);
    formData.append("longitude", longitude);
    formData.append("latitude", latitude);
    formData.append("description", description);

    fetch("/upload", { method: "POST", body: formData })
      .then((res) => res.json())
      .then((data) => console.log("Upload success:", data))
      .catch((err) => console.error("Upload error:", err));

    closeForm();  // hide popup after submit
  });

  function closeForm() {
    document.getElementById("userForm").style.display = "none";
  }

  function openForm() {
    document.getElementById("userForm").style.display = "block";
  }
</script>
                </div>
              </div>
              <div
                class="u-container-style u-layout-cell u-size-30 u-layout-cell-2"
              >
                <div class="u-container-layout u-container-layout-2">
                  
                </div>
              </div>
            </div>
          </div>
        </div>
        <div
          class="data-layout-selected u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-2"
        >
          <div class="u-layout">
            <div class="u-layout-row">
              <div class="u-container-style u-layout-cell u-size-60 u-layout-cell-3">
                <div class="u-container-layout u-container-layout-3">
                    <div class="iframe-container">
                      <iframe src="http://127.0.0.1:8052/" id="map"></iframe>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer
      class="u-align-center u-clearfix u-container-align-center u-footer u-grey-80 u-footer"
      id="footer"
    >
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-small-text u-text u-text-variant u-text-1">
          &nbsp;~ &amp;hacks 2025 ~
        </p>
      </div>
    </footer>
    <section class="u-backlink u-clearfix u-grey-80">
      This
      <a href="https://nicepage.com/website-templates">Website Template</a> was
      created with Nicepage Website Builder
    </section>
  </body>
</html>
